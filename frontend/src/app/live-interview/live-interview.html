<div class="interview-container">
    <div class="main-content" [class.split-view]="showCodeEditor || showNotes">

        <!-- Video Section -->
        <div class="video-section" [class.collapsed]="showCodeEditor || showNotes">
            <div class="video-wrapper">
                <div class="videos">
                    @if (role === 'host') {
                        <!-- HOST VIEW -->
                        <div class="my-cam-warper">
                            <video #localVideo autoplay muted playsinline></video>
                            <div class="participant-name">{{ candidateName }} (You)</div>
                            <div class="status-indicator">
                                üü¢ Online
                                @if (!micEnabled) {
                                    <span>üîá Muted</span>
                                }
                            </div>
                            <div class="controls">
                                <button (click)="toggleMic()">
                                    <i class="fas" [ngClass]="micEnabled ? 'fa-microphone' : 'fa-microphone-slash'"></i>
                                </button>
                                <button (click)="toggleCamera()">
                                    <i class="fas" [ngClass]="cameraEnabled ? 'fa-video' : 'fa-video-slash'"></i>
                                </button>
                            </div>
                        </div>

                        <div class="remote-cam">
                            <video #remoteVideo autoplay playsinline></video>
                            <div class="participant-name">Candidate</div>
                            <div class="status-indicator">üü¢ Online</div>
                        </div>
                    } @else {

                        <div class="my-cam-warper">
                            <video #localVideo autoplay muted playsinline></video>
                            <div class="participant-name">{{ candidateName }} (You)</div>
                            <div class="status-indicator">
                                üü¢ –û–Ω–ª–∞–π–Ω
                                @if (!micEnabled) {
                                    <span>üîá Muted</span>
                                }
                            </div>
                            <div class="controls">
                                <button (click)="toggleMic()">
                                    <i class="fas" [ngClass]="micEnabled ? 'fa-microphone' : 'fa-microphone-slash'"></i>
                                </button>
                                <button (click)="toggleCamera()">
                                    <i class="fas" [ngClass]="cameraEnabled ? 'fa-video' : 'fa-video-slash'"></i>
                                </button>
                            </div>
                        </div>
                        <!-- GUEST VIEW -->
                        <div class="remote-cam">
                            <video #remoteVideo autoplay playsinline></video>
                            <div class="participant-name">Interviewer</div>
                            <div class="status-indicator">üü¢ Online</div>
                        </div>
                    }
                </div>

                <!-- Controls -->
                <div class="interview-controls">
                    <button (click)="toggleCodeEditor()"
                            [class.active]="showCodeEditor"
                            class="control-btn code-btn">
                        üíª {{showCodeEditor ? 'Hide Code Editor' : 'Show Code Editor'}}
                    </button>

                    @if (isHost) {
                        <button (click)="toggleNotes()"
                                [class.active]="showNotes"
                                class="control-btn notes-btn">
                            üìù {{showNotes ? 'Hide Notes' : 'Show Notes'}}
                        </button>
                    }

                    <button (click)="leaveCall()" class="control-btn leave-btn">
                        ‚õî Leave Meet
                    </button>
                </div>
            </div>
        </div>

        <!-- Code Editor -->
        @if (showCodeEditor) {
            <div class="code-editor-section">
                <app-shared-code-editor
                    [roomId]="roomId"
                    [userId]="currentUserId"
                    [userName]="candidateName"
                    [isHost]="isHost">
                </app-shared-code-editor>
            </div>
        }

        <!-- Interview Notes -->
        <div class="notes-section"
             [hidden]="!showNotes"
             [class.visible]="showNotes">

            @if (isHost && notesInitialized) {
                <app-interview-notes
                    [roomId]="roomId"
                    [candidateName]="candidateName"
                    [isHost]="isHost"
                    [interviewerId]="interviewerId">
                </app-interview-notes>
            }

            @if (isHost && showNotes && !notesInitialized) {
                <div class="notes-loading">
                    üìù Loading notes...
                </div>
            }
        </div>
    </div>
</div>
